# Fullstack Chat API Project

## Overview

This is a school assignment for a chat application called (Elden) Chappy, built with the MERN stack (MongoDB, Express, React, and Node.js). The application allows users to send messages directly to specific users or in channels. It also includes authentication to ensure that only logged-in users can participate in certain channels.

## Features

- **User Authentication**: Registration and login for users.
- **Open and Locked Channels**: Users can view and send messages in open channels, while locked channels are only accessible to logged-in users.
- **Direct Messages**: Users can send messages directly to each other.
- **RESTful API**: The backend application offers a RESTful API for managing users and messages.

## Installation

Follow the steps below to install and run the project locally:

1. **Clone the repository:**

   ```bash
   git clone https://github.com/Martinf88/FULLSTACK-CHAT-API-PROJECT.git
   cd FULLSTACK-CHAT-API-PROJECT
   ```

2. **Install dependencies:**
   Install dependencies for both frontend and backend:

   ```bash
   npm install
   cd backendSrc
   npm install
   ```

3. **Configure environment variables:**
   Create a `.env` file in the backend folder and add your environment variables:

   ```plaintext
   CONNECTION_STRING=<your-mongodb-uri>
   SECRET=<a-secret-value>
   PORT=<ex. 1337>
   ```

4. **Run the application:**
   Start the backend server:
   ```bash
   npm run start-backend
   ```
   Start the frontend application:
   ```bash
   npm run dev
   ```

## Usage

Open your browser and navigate to `http://localhost:????` to use the application.

## API Documentation

See below for details about API endpoints:

### Users

#### Get All Users

- **Method**: `GET`
- **URL**: `/api/users`
- **Response**:
  - **200 OK**: List of users.
  - **404 Not Found**: If no users exist.

#### Register a User

- **Method**: `POST`
- **URL**: `/api/users/register`
- **Body**:
  ```json
  {
    "username": "TarnishedKnight",
    "password": "sword123"
  }
  ```
- **Response**:
  - **201 Created**: If the user was created successfully.
  - **400 Bad Request**: If validation fails.

#### Login

- **Method**: `POST`
- **URL**: `/api/users/login`
- **Body**:
  ```json
  {
    "username": "TarnishedKnight",
    "password": "sword123"
  }
  ```
- **Response**:
  - **200 OK**: If login is successful, returns JWT token.
  - **401 Unauthorized**: If login fails.

### Channels

#### Get All Channels

- **Method**: `GET`
- **URL**: `/api/channels`
- **Response**:
  - **200 OK**: List of channels.
  - **404 Not Found**: If no channels exist.

### Messages

#### Send a Message

- **Method**: `POST`
- **URL**: `/api/messages`
- **Body**:
  ```json
  {
    "content": "Welcome to Limgrave!",
    "channelId": "12345",
    "senderId": "TarnishedKnight"
  }
  ```
- **Response**:
  - **201 Created**: If the message was sent successfully.
  - **400 Bad Request**: If validation fails.

#### Get Messages in a Channel

- **Method**: `GET`
- **URL**: `/api/messages/:channelId`
- **Response**:
  - **200 OK**: List of messages for the specified channel.
  - **404 Not Found**: If no messages exist for the specified channel.

### Direct Messages

#### Send a Direct Message

- **Method**: `POST`
- **URL**: `/api/directMessages`
- **Body**:
  ```json
  {
    "content": "Hey, how are you?",
    "senderId": "TarnishedKnight",
    "receiverId": "EldenSeeker"
  }
  ```
- **Response**:
  - **201 Created**: If the direct message was sent successfully.
  - **400 Bad Request**: If validation fails.

#### Get Direct Messages Between Two Users

- **Method**: `GET`
- **URL**: `/api/directMessages/:senderId/:receiverId`
- **Response**:
  - **200 OK**: List of direct messages between the two users.
  - **404 Not Found**: If no direct messages exist between the specified users.

## Data Model

The chat application uses MongoDB to store the following data:

### Channels

- **name** (string): The name of the channel (e.g., 'general', 'limgrave').
- **isLocked** (boolean): A flag indicating whether the channel is locked (true) or open (false).
- **users** (array of objects):
  - **username** (string): The username of a user participating in the channel.
  - **password** (string): The password (optional, if authentication is needed to join the channel).

### Messages

- **content** (string): The message content.
- **channelId** (string): The ID of the channel where the message was sent.
- **senderId** (string): The ID of the user who sent the message.

### Direct Messages

- **content** (string): The content of the direct message.
- **senderId** (string): The ID of the user who sent the direct message.
- **receiverId** (string): The ID of the user who received the direct message.

### MongoDB Specific

- **\_id** (string): The unique identifier automatically generated by MongoDB for each document (channels, messages, directMessages or users).
